<section id="MainProduct-{{ section.id }}" class="section-{{ section.id }}-padding gradient color-{{ section.settings.color_scheme }}" data-section="{{ section.id }}">
  
  {{ 'section-main-product.css' | asset_url | stylesheet_tag }}
  {{ 'component-accordion.css' | asset_url | stylesheet_tag }}
  {{ 'component-price.css' | asset_url | stylesheet_tag }}
  {{ 'component-slider.css' | asset_url | stylesheet_tag }}
  {{ 'component-rating.css' | asset_url | stylesheet_tag }}
  {{ 'component-loading-spinner.css' | asset_url | stylesheet_tag }}
  {{ 'component-deferred-media.css' | asset_url | stylesheet_tag }}

  {% unless product.has_only_default_variant %}
    {{ 'component-product-variant-picker.css' | asset_url | stylesheet_tag }}
    {{ 'component-swatch-input.css' | asset_url | stylesheet_tag }}
    {{ 'component-swatch.css' | asset_url | stylesheet_tag }}
  {% endunless %}

  {%- style -%}
    /* --- 1. DARK THEME STYLING (Competitor Style) --- */
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
      padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
      background-color: #121212 !important; /* Force Black Background */
      color: #ffffff !important;
    }

    @media screen and (min-width: 750px) {
      .section-{{ section.id }}-padding {
        padding-top: {{ section.settings.padding_top }}px;
        padding-bottom: {{ section.settings.padding_bottom }}px;
      }
    }

    /* Text Colors */
    h1, h2, h3, .h1, .h2, .product__title h1 { color: #ffffff !important; font-weight: 400; letter-spacing: 1px; }
    .product__text, .product__description, .product__description p, .price-item { color: #B0B0B0 !important; }
    .price-item--sale { color: #E9E2D8 !important; }
    .product__title a { text-decoration: none; }

    /* --- 2. MISSING BLOCK: BENEFITS GRID --- */
    .benefits-grid { margin: 20px 0; border-top: 1px solid #333; padding-top: 20px; }
    .benefits-grid__list { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .benefits-grid__item { display: flex; align-items: center; gap: 10px; }
    .benefits-grid__text { font-size: 12px; line-height: 1.4; color: #b0b0b0; }
    .benefits-grid__text strong { color: #fff; }

    /* --- 3. MISSING BLOCK: SHIPPING BAR --- */
    .shipbar { margin: 20px 0; background: #03231A; border-radius: 8px; padding: 12px; display: flex; align-items: center; gap: 15px; }
    .shipbar__text { font-size: 12px; color: #D2F1E3; font-weight: 500; }

    /* --- 4. MISSING BLOCK: CUSTOM TABS --- */
    .pit-container { margin-top: 30px; border-top: 1px solid #454545; }
    .pit-tabs { display: flex; border-bottom: 1px solid #454545; margin-bottom: 15px; }
    .pit-tab { flex: 1; padding: 15px; background: transparent; border: none; color: #B0B0B0; cursor: pointer; font-weight: 600; border-bottom: 2px solid transparent; }
    .pit-tab.is-active { color: #fff; border-bottom-color: #fff; }
    .pit-panel { display: none; color: #B0B0B0; font-size: 14px; line-height: 1.6; }
    .pit-panel.is-active { display: block; animation: fadeIn 0.5s; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    /* --- 5. MISSING BLOCK: STICKY ATC --- */
    .sticky-cta { position: fixed; z-index: 99; bottom: 20px; right: 20px; background: #1a1a1a; padding: 10px; border-radius: 12px; display: flex; align-items: center; gap: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); transform: translateY(200%); transition: transform 0.3s ease; border: 1px solid #333; }
    .sticky-cta.is-visible { transform: translateY(0); }
    .sticky-cta img { width: 50px; height: 50px; border-radius: 6px; object-fit: cover; }
    .sticky-cta button { background: #fff; color: #000; border: none; padding: 10px 20px; font-weight: bold; border-radius: 6px; cursor: pointer; }

    /* --- 6. MISSING BLOCK: UPSELL --- */
    .upsell-section { margin-top: 40px; border-top: 1px solid #333; padding-top: 30px; }
    .upsell-card { background: #fff; border-radius: 12px; padding: 15px; display: flex; gap: 15px; align-items: center; margin-top:10px; }
    
    /* Size Modal */
    .sg-modal { position: fixed; inset: 0; z-index: 10000; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.7); backdrop-filter: blur(2px); }
    .sg-panel { background: #fff; padding: 30px; border-radius: 12px; width: 90%; max-width: 500px; position: relative; color: #000; }
    .sg-close { position: absolute; top: 10px; right: 15px; background: none; border: none; font-size: 24px; cursor: pointer; }
    .sg-table td, .sg-table th { padding: 10px; border-bottom: 1px solid #eee; text-align: left; }

  {%- endstyle -%}

  <script src="{{ 'product-info.js' | asset_url }}" defer="defer"></script>
  <script src="{{ 'product-form.js' | asset_url }}" defer="defer"></script>

  {% assign variant_images = product.images | where: 'attached_to_variant?', true | map: 'src' %}
  
  <div class="page-width">
    <div class="product product--{{ section.settings.media_size }} product--{{ section.settings.media_position }} grid grid--1-col {% if product.media.size > 0 %}grid--2-col-tablet{% else %}product--no-media{% endif %}">
      
      <div class="grid__item product__media-wrapper">
        {% render 'product-media-gallery', variant_images: variant_images %}
      </div>

      <div class="product__info-wrapper grid__item">
        <product-info
          id="ProductInfo-{{ section.id }}"
          class="product__info-container"
          data-section="{{ section.id }}"
          data-url="{{ product.url }}"
        >
          {%- assign product_form_id = 'product-form-' | append: section.id -%}

          {%- for block in section.blocks -%}
            {%- case block.type -%}
              {%- when '@app' -%}
                {% render block %}
              
              {%- when 'text' -%}
                <p class="product__text inline-richtext" {{ block.shopify_attributes }}>
                  {{- block.settings.text -}}
                </p>
              
              {%- when 'title' -%}
                <div class="product__title" {{ block.shopify_attributes }}>
                  <h1>{{ product.title | escape }}</h1>
                </div>
              
              {%- when 'price' -%}
                <div id="price-{{ section.id }}" role="status" {{ block.shopify_attributes }}>
                  {%- render 'price', product: product, use_variant: true, show_badges: true, price_class: 'price--large' -%}
                </div>
                
                <div class="benefits-grid">
                  <div class="benefits-grid__list">
                    <div class="benefits-grid__item">
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="#fff" stroke-width="2"/><path d="M8 12L11 15L16 9" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                      <div class="benefits-grid__text">No PFAS/PFOA.<br><strong>No hormone disruptors.</strong></div>
                    </div>
                    <div class="benefits-grid__item">
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M12 3V5M12 19V21M5 12H3M21 12H19" stroke="#fff" stroke-width="2"/></svg>
                      <div class="benefits-grid__text">Heat Resistant<br><strong>up to 600¬∞C</strong></div>
                    </div>
                    <div class="benefits-grid__item">
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="9" stroke="#fff" stroke-width="2"/></svg>
                      <div class="benefits-grid__text">Constructed <strong>Non-Stick Surface</strong></div>
                    </div>
                    <div class="benefits-grid__item">
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none"><rect x="3" y="3" width="18" height="18" rx="2" stroke="#fff" stroke-width="2"/></svg>
                      <div class="benefits-grid__text">Compatible With <strong>All Cooktops</strong></div>
                    </div>
                  </div>
                </div>

              {%- when 'description' -%}
                {%- if product.description != blank -%}
                  <div class="product__description rte quick-add-hidden" {{ block.shopify_attributes }}>
                    {{ product.description | truncatewords: 40 }}
                  </div>
                {%- endif -%}

              {%- when 'variant_picker' -%}
                {% render 'product-variant-picker', product: product, block: block, product_form_id: product_form_id %}
                
                <div style="margin-top:10px;">
                    <button type="button" class="size-guide-trigger" style="background:none; border:none; color:#fff; text-decoration:underline; cursor:pointer;">üìè Size Guide</button>
                </div>

              {%- when 'buy_buttons' -%}
                {%- render 'buy-buttons', block: block, product: product, product_form_id: product_form_id, section_id: section.id, show_pickup_availability: true -%}

                <div class="shipbar">
                   <div style="font-size: 24px;">üöö</div>
                   <div class="shipbar__text">
                     <strong>Free Shipping & Easy Returns</strong><br>
                     30-Day Guarantee ‚Ä¢ Lifetime Warranty
                   </div>
                </div>
                
                <div style="margin-top: 15px; padding: 15px; background: #1A1A1A; border-radius: 8px; font-size: 13px; color: #888; display:flex; gap:10px; align-items:center;">
                   <div style="font-size:20px;">üå±</div>
                   <div><strong>Impact Note:</strong> Part of your order helps fund the development of safe, non-toxic kitchenware.</div>
                </div>

            {%- endcase -%}
          {%- endfor -%}

          <div class="pit-container">
            <div class="pit-tabs">
              <button class="pit-tab is-active" data-target="panel-desc">Description</button>
              <button class="pit-tab" data-target="panel-health">Health Benefits</button>
              <button class="pit-tab" data-target="panel-care">Care & Use</button>
            </div>
            <div id="panel-desc" class="pit-panel is-active">
              {{ product.description }}
            </div>
            <div id="panel-health" class="pit-panel">
              <p><strong>Pure Titanium:</strong> The safest metal for the body. Used in medical implants, naturally non-toxic.</p>
              <p><strong>Retains Nutrients:</strong> Cooks evenly at lower temperatures preventing nutrient loss.</p>
            </div>
            <div id="panel-care" class="pit-panel">
              <p>Dishwasher safe. Titanium interior is safe for abrasive scrubs. Works on Induction, Gas, and Electric.</p>
            </div>
          </div>
          
          <div class="upsell-section">
            <h3 style="color:#fff; font-size:18px; margin-bottom:15px;">Complete Your Kitchen</h3>
            <div class="upsell-card">
              <div style="width:60px; height:60px; background:#eee; border-radius:8px;"></div>
              <div style="flex:1;">
                <div style="font-weight:bold; color:#000;">Titanium Utensils Set</div>
                <div style="font-size:12px; color:#555;">$199.00</div>
              </div>
              <button style="background:#A3835F; color:#fff; border:none; padding:8px 12px; border-radius:6px; cursor:pointer;">Add</button>
            </div>
          </div>

        </product-info>
      </div>
    </div>
  </div>
</section>

<div id="sticky-cta-wrapper" class="sticky-cta">
  <div style="display:flex; gap:10px; align-items:center;">
    {{ product.featured_image | image_url: width: 100 | image_tag }}
    <div style="color:#fff;">
      <div style="font-weight:bold; font-size:14px;">{{ product.title }}</div>
      <div style="color:#ff2422; font-size:12px; font-weight:bold;">‚ö†Ô∏è ALMOST SOLD OUT</div>
    </div>
  </div>
  <button onclick="document.querySelector('.product-form__submit').click()">ADD TO CART</button>
</div>

<div id="sg-modal" class="sg-modal" hidden>
  <div class="sg-backdrop" onclick="document.getElementById('sg-modal').hidden = true" style="position:absolute; inset:0;"></div>
  <div class="sg-panel">
    <button class="sg-close" onclick="document.getElementById('sg-modal').hidden = true">&times;</button>
    <h2 style="margin-top:0; color:#000;">Size Guide</h2>
    <table class="sg-table" style="width:100%; border-collapse:collapse; margin-top:20px; color:#000;">
      <thead><tr style="background:#f4f4f4;"><th>Size</th><th>Diameter</th><th>Length</th></tr></thead>
      <tbody>
        <tr><td>Standard</td><td>10.2"</td><td>18.9"</td></tr>
        <tr><td>Large</td><td>11"</td><td>20"</td></tr>
        <tr><td>Extra Large</td><td>11.8"</td><td>21"</td></tr>
      </tbody>
    </table>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  
  // 1. TABS LOGIC
  const tabs = document.querySelectorAll('.pit-tab');
  const panels = document.querySelectorAll('.pit-panel');
  if(tabs.length > 0) {
    tabs.forEach(tab => {
      tab.addEventListener('click', function(e) {
        e.preventDefault();
        tabs.forEach(t => t.classList.remove('is-active'));
        panels.forEach(p => p.classList.remove('is-active'));
        this.classList.add('is-active');
        document.getElementById(this.dataset.target).classList.add('is-active');
      });
    });
  }

  // 2. SIZE GUIDE LOGIC
  document.querySelector('.size-guide-trigger')?.addEventListener('click', (e) => {
    e.preventDefault();
    document.getElementById('sg-modal').hidden = false;
  });

  // 3. STICKY ATC LOGIC
  window.addEventListener('scroll', () => {
    const cta = document.getElementById('sticky-cta-wrapper');
    const mainBtn = document.querySelector('.product-form__submit');
    if(mainBtn && cta) {
      if(mainBtn.getBoundingClientRect().bottom < 0) cta.classList.add('is-visible');
      else cta.classList.remove('is-visible');
    }
  });

  // 4. AJAX CART DRAWER FORCE OPEN (FIXED)
  const forms = document.querySelectorAll('form[action*="/cart/add"]');
  forms.forEach(form => {
    form.addEventListener('submit', function(e) {
      // Don't prevent default immediately if you want the theme scripts to run, 
      // BUT for safety, let's delay the drawer opening to ensure the item is added.
      
      setTimeout(() => {
        const cartBubble = document.querySelector('#cart-icon-bubble');
        const cartDrawer = document.querySelector('cart-drawer');
        
        // Method A: Check for official Dawn Drawer method
        if (cartDrawer && typeof cartDrawer.open === 'function') {
           // We might need to re-fetch the drawer content if the theme didn't update it
           fetch(window.Shopify.routes.root + '?section_id=cart-drawer')
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const doc = parser.parseFromString(html, 'text/html');
              const newContent = doc.querySelector('cart-drawer');
              if(newContent) {
                cartDrawer.innerHTML = newContent.innerHTML;
                cartDrawer.classList.remove('is-empty');
                cartDrawer.open();
              }
            });
        } 
        // Method B: Fallback Click
        else if (cartBubble) {
           cartBubble.click();
        }
      }, 800); // 800ms delay to allow the theme's default JS to add item to cart
    });
  });

});
</script>

{% schema %}
{
  "name": "t:sections.main-product.name",
  "tag": "section",
  "class": "section",
  "blocks": [
    {"type": "@app"},
    {"type": "text", "name": "t:sections.main-product.blocks.text.name", "settings": [{"type": "inline_richtext", "id": "text", "default": "Text block", "label": "Text"}]},
    {"type": "title", "name": "t:sections.main-product.blocks.title.name", "limit": 1},
    {"type": "price", "name": "t:sections.main-product.blocks.price.name", "limit": 1},
    {"type": "sku", "name": "t:sections.main-product.blocks.sku.name", "limit": 1},
    {"type": "inventory", "name": "t:sections.main-product.blocks.inventory.name", "limit": 1},
    {"type": "quantity_selector", "name": "t:sections.main-product.blocks.quantity_selector.name", "limit": 1},
    {"type": "variant_picker", "name": "t:sections.main-product.blocks.variant_picker.name", "limit": 1, "settings": [{"type": "select", "id": "picker_type", "options": [{"value": "dropdown", "label": "Dropdown"}, {"value": "button", "label": "Pills"}], "default": "button", "label": "Picker type"}]},
    {"type": "buy_buttons", "name": "t:sections.main-product.blocks.buy_buttons.name", "limit": 1, "settings": [{"type": "checkbox", "id": "show_dynamic_checkout", "default": true, "label": "Show dynamic checkout buttons"}, {"type": "checkbox", "id": "show_gift_card_recipient", "default": true, "label": "Show gift card recipient form"}]},
    {"type": "description", "name": "t:sections.main-product.blocks.description.name", "limit": 1},
    {"type": "share", "name": "t:sections.main-product.blocks.share.name", "limit": 1},
    {"type": "custom_liquid", "name": "t:sections.custom-liquid.name", "settings": [{"type": "liquid", "id": "custom_liquid", "label": "Custom Liquid"}]},
    {"type": "collapsible_tab", "name": "t:sections.main-product.blocks.collapsible_tab.name", "settings": [{"type": "text", "id": "heading", "default": "Collapsible row", "label": "Heading"}, {"type": "richtext", "id": "content", "label": "Content"}]},
    {"type": "popup", "name": "t:sections.main-product.blocks.popup.name", "settings": [{"type": "text", "id": "text", "default": "Pop-up link text", "label": "Label"}, {"type": "page", "id": "page", "label": "Page"}]},
    {"type": "rating", "name": "t:sections.main-product.blocks.rating.name", "limit": 1}
  ],
  "settings": [
    {
      "type": "checkbox",
      "id": "enable_sticky_info",
      "default": true,
      "label": "t:sections.main-product.settings.enable_sticky_info.label"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "t:sections.main-product.settings.header.content"
    },
    {
      "type": "select",
      "id": "media_size",
      "options": [
        { "value": "small", "label": "t:sections.main-product.settings.media_size.options__1.label" },
        { "value": "medium", "label": "t:sections.main-product.settings.media_size.options__2.label" },
        { "value": "large", "label": "t:sections.main-product.settings.media_size.options__3.label" }
      ],
      "default": "large",
      "label": "t:sections.main-product.settings.media_size.label"
    },
    {
      "type": "checkbox",
      "id": "constrain_to_viewport",
      "default": true,
      "label": "t:sections.main-product.settings.constrain_to_viewport.label"
    },
    {
      "type": "select",
      "id": "media_fit",
      "options": [
        { "value": "contain", "label": "t:sections.main-product.settings.media_fit.options__1.label" },
        { "value": "cover", "label": "t:sections.main-product.settings.media_fit.options__2.label" }
      ],
      "default": "contain",
      "label": "t:sections.main-product.settings.media_fit.label"
    },
    {
      "type": "select",
      "id": "gallery_layout",
      "options": [
        { "value": "stacked", "label": "t:sections.main-product.settings.gallery_layout.options__1.label" },
        { "value": "columns", "label": "t:sections.main-product.settings.gallery_layout.options__2.label" },
        { "value": "thumbnail", "label": "t:sections.main-product.settings.gallery_layout.options__3.label" },
        { "value": "thumbnail_slider", "label": "t:sections.main-product.settings.gallery_layout.options__4.label" }
      ],
      "default": "stacked",
      "label": "t:sections.main-product.settings.gallery_layout.label"
    },
    {
      "type": "select",
      "id": "mobile_thumbnails",
      "options": [
        { "value": "columns", "label": "t:sections.main-product.settings.mobile_thumbnails.options__1.label" },
        { "value": "show", "label": "t:sections.main-product.settings.mobile_thumbnails.options__2.label" },
        { "value": "hide", "label": "t:sections.main-product.settings.mobile_thumbnails.options__3.label" }
      ],
      "default": "hide",
      "label": "t:sections.main-product.settings.mobile_thumbnails.label"
    },
    {
      "type": "select",
      "id": "media_position",
      "options": [
        { "value": "left", "label": "t:sections.main-product.settings.media_position.options__1.label" },
        { "value": "right", "label": "t:sections.main-product.settings.media_position.options__2.label" }
      ],
      "default": "left",
      "label": "t:sections.main-product.settings.media_position.label"
    },
    {
      "type": "select",
      "id": "image_zoom",
      "options": [
        { "value": "lightbox", "label": "t:sections.main-product.settings.image_zoom.options__1.label" },
        { "value": "hover", "label": "t:sections.main-product.settings.image_zoom.options__2.label" },
        { "value": "none", "label": "t:sections.main-product.settings.image_zoom.options__3.label" }
      ],
      "default": "lightbox",
      "label": "t:sections.main-product.settings.image_zoom.label"
    },
    {
      "type": "checkbox",
      "id": "hide_variants",
      "default": false,
      "label": "t:sections.main-product.settings.hide_variants.label"
    },
    {
      "type": "checkbox",
      "id": "enable_video_looping",
      "default": false,
      "label": "t:sections.main-product.settings.enable_video_looping.label"
    },
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 36
    }
  ]
}
{% endschema %}
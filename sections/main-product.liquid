{% comment %} 
  COMPLETE HYBRID CODE: User Logic + Competitor Styling/Functionality 
{% endcomment %}

<section id="MainProduct-{{ section.id }}" class="section-{{ section.id }}-padding gradient color-{{ section.settings.color_scheme }} custom_bg_black_gradient" data-section="{{ section.id }}">
  
  {{ 'section-main-product.css' | asset_url | stylesheet_tag }}
  {{ 'component-accordion.css' | asset_url | stylesheet_tag }}
  {{ 'component-price.css' | asset_url | stylesheet_tag }}
  {{ 'component-slider.css' | asset_url | stylesheet_tag }}
  {{ 'component-rating.css' | asset_url | stylesheet_tag }}
  {{ 'component-deferred-media.css' | asset_url | stylesheet_tag }}

  {%- style -%}
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
      padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
    }

    @media screen and (min-width: 750px) {
      .section-{{ section.id }}-padding {
        padding-top: {{ section.settings.padding_top }}px;
        padding-bottom: {{ section.settings.padding_bottom }}px;
      }
    }
    
    /* COMPETITOR STYLES INTEGRATION */
    #MainProduct-{{ section.id }} {
      background: linear-gradient(90deg,#3b3e41,#181a1b);
      color: #fff;
    }
    
    .product__title h1 {
      font-family: 'Neue Montreal', sans-serif !important;
      font-weight: 400 !important;
      font-size: 32px !important;
      line-height: 130% !important;
      letter-spacing: 0.04em !important;
      text-transform: capitalize !important;
      color: #FFFFFF !important;
      margin: 0 0 12px 0;
    }

    .product__text.inline-richtext {
      font-family: 'Neue Montreal', sans-serif;
      font-weight: 500;
      font-size: 20px;
      color: #B0B0B0;
      margin-bottom: 12px;
    }

    /* Benefits Grid Styles */
    .benefits-grid { color: #b0b0b0; margin: 32px 0; }
    .benefits-grid__list { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
    .benefits-grid__item { display: flex; align-items: center; min-height: 40px; }
    .benefits-grid__icon { width: 24px; height: 24px; margin-right: 8px; }
    .benefits-grid__text { font-size: 14px; line-height: 1.5; }
    .benefits-grid__text strong { color: #fff; font-weight: 400; }

    /* Custom Price Styles */
    .ctm-price__row { display: flex; align-items: center; gap: 16px; flex-wrap: wrap; margin-bottom: 20px;}
    .ctm-price__current { font-size: 48px; color: #E9E2D8; line-height: 1.3; }
    .ctm-price__compare { font-size: 48px; color: #888888; text-decoration: line-through; line-height: 1.3; }
    .ctm-price__save { background: #097350; color: #E9E2D8; padding: 5px 16px; border-radius: 32px; font-size: 16px; font-weight: 500; }

    /* Features Icons Scrolling */
    .pf-wrap { color: #D4C7B4; margin: 32px 0; overflow: hidden; }
    .pf-track { display: flex; gap: 12px; overflow-x: auto; scrollbar-width: none; }
    .pf-item { width: 87px; flex: 0 0 87px; text-align: center; }
    .pf-icon img { width: 40px; height: 40px; margin: 0 auto 8px; display: block; }
    .pf-text { font-size: 12px; line-height: 1.5; }

    /* Bundle/Variant Tabs */
    .pb-sizes { margin: 32px 0; }
    .pb-sizes-head { display: flex; justify-content: space-between; margin-bottom: 20px; color: #fff; font-weight: 500;}
    .pb-size-tabs { display: grid; grid-template-columns: repeat(4, 1fr); }
    .pb-size-tab { 
      padding: 16px; border: 1px solid #454545; background: transparent; color: #B0B0B0; cursor: pointer; 
      font-size: 16px; font-weight: 500; 
    }
    .pb-size-tab.is-active { border: 1.5px solid #FFF; color: #FFF; }
    .pb-size-tab:first-child { border-radius: 12px 0 0 12px; }
    .pb-size-tab:last-child { border-radius: 0 12px 12px 0; }

    /* Bundle Cards */
    .pb-title { color: #fff; font-size: 16px; font-weight: 500; margin-top: 20px; margin-bottom: 10px; }
    .pb-card { border-radius: 12px; margin: 16px 0; padding: 20px; position: relative; border: 1.5px solid #E9E2D8; cursor: pointer;}
    .pb-card.is-collapsed { background: transparent; }
    .pb-card:not(.is-collapsed) { background: #F6F4F0; border-color: transparent; }
    .pb-card:not(.is-collapsed) .pb-name { color: #2C1F1C; }
    .pb-head { display: flex; justify-content: space-between; align-items: flex-start; width: 100%; border: none; background: none; text-align: left;}
    .pb-name { font-size: 16px; font-weight: 500; color: #fff; }
    .pb-price { font-size: 20px; color: #fff; font-weight: 500; }
    .pb-badge { position: absolute; top: -1px; right: -1px; background: #BCA588; color: #2C1F1C; padding: 3px 12px; border-radius: 0 12px 0 12px; font-size: 12px; text-transform: uppercase; }

    /* ATC Button */
    .pb-atc-btn {
      width: 100%; padding: 18px; border: none; border-radius: 16px;
      font-size: 20px; font-weight: 500; background: #ffffff; color: #121212; cursor: pointer;
      margin-top: 20px;
    }
    .pb-atc-btn:hover { opacity: 0.95; }

    /* Shipping Bar */
    .shipbar__inner { background: #03231A; border-radius: 12px; display: flex; align-items: stretch; margin: 20px 0; color: #D2F1E3; }
    .shipbar__left { padding: 12px 20px; border-right: 1px solid rgba(255,255,255,0.08); display: flex; align-items: center; justify-content: center; }
    .shipbar__list { display: flex; list-style: none; padding: 12px 20px; margin: 0; gap: 20px; overflow-x: auto; }
    .shipbar__item { display: flex; align-items: center; gap: 8px; white-space: nowrap; font-size: 12px; }

    /* Accordions & Tabs */
    .pit-tabs { display: grid; grid-template-columns: repeat(3, 1fr); border-bottom: 1px solid #454545; margin-bottom: 24px; }
    .pit-tab { padding: 17px; background: transparent; border: none; color: #B0B0B0; font-size: 16px; cursor: pointer; position: relative;}
    .pit-tab.is-active { color: #fff; }
    .pit-tab.is-active::after { content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 1px; background: #fff; }
    .pfaq-item { border-bottom: 1px solid rgba(255,255,255,0.15); }
    .pfaq-head { width: 100%; display: flex; justify-content: space-between; padding: 16px 0; background: transparent; border: none; color: #fff; font-size: 16px; cursor: pointer; text-align: left; }
    
    /* Sticky CTA */
    .sticky-cta {
      position: fixed; z-index: 999; bottom: 20px; right: 20px;
      display: flex; align-items: center; gap: 16px; background: #0a0a0a; color: #fff;
      padding: 12px; border-radius: 14px; box-shadow: 0 12px 28px rgba(0,0,0,0.35);
      opacity: 0; transform: translateY(20px); transition: all 0.3s ease; pointer-events: none;
    }
    .sticky-cta.is-visible { opacity: 1; transform: translateY(0); pointer-events: auto; }
    .sticky-cta__btn { background: #fff; color: #121212; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: bold; }

    @media screen and (max-width: 750px) {
        .ctm-price__current, .ctm-price__compare { font-size: 32px; }
        .pb-size-tabs { grid-template-columns: 1fr 1fr; }
        .sticky-cta { left: 0; right: 0; bottom: 0; border-radius: 0; width: 100%; justify-content: center;}
        .sticky-cta__thumb, .sticky-cta__body { display: none; }
        .sticky-cta__btn { width: 100%; text-align: center; }
    }
  {%- endstyle -%}

  <div class="page-width">
    <div class="product grid grid--1-col {% if product.media.size > 0 %}grid--2-col-tablet{% endif %}">
      
      <div class="grid__item product__media-wrapper">
        {% render 'product-media-gallery', variant_images: variant_images %}
      </div>

      <div class="product__info-wrapper grid__item">
        <section id="ProductInfo-{{ section.id }}" class="product__info-container product__column-sticky">
          
          <div class="product__title">
            <h1>{{ product.title | escape }}</h1>
          </div>

          <div class="loox-rating" style="margin-bottom: 15px;">
             <span style="color:#b57c46">★★★★★</span> <span style="color:#fff">4.8 (2,967 reviews)</span>
          </div>

          <p class="product__text inline-richtext">
            Immaculate Performance, Without The Chemicals.
          </p>

          <div class="price price--large">
            <div class="ctm-price__row">
              <s class="ctm-price__compare">{{ product.compare_at_price_max | money }}</s>
              <span class="ctm-price__current">{{ product.price | money }}</span>
              <span class="ctm-price__save">SALE ENDS SOON!</span>
            </div>
          </div>

          <div class="benefits-grid">
            <div class="benefits-grid__list">
              <div class="benefits-grid__item">
                <img class="benefits-grid__icon" src="https://cdn.shopify.com/s/files/1/0742/4635/7257/files/icons_31.svg" alt="">
                <div class="benefits-grid__text">No PFAS, PTFE & PFOA.<br><strong>No hormone disruptors.</strong></div>
              </div>
              <div class="benefits-grid__item">
                <img class="benefits-grid__icon" src="https://cdn.shopify.com/s/files/1/0742/4635/7257/files/icons_32.svg" alt="">
                <div class="benefits-grid__text">Extreme Heat Resistant<br><strong>up to 1112°F / 600°C</strong></div>
              </div>
              <div class="benefits-grid__item">
                <img class="benefits-grid__icon" src="https://cdn.shopify.com/s/files/1/0742/4635/7257/files/icons_33.svg" alt="">
                <div class="benefits-grid__text">Constructed <strong>Non-Stick SlipScale™</strong> surface.</div>
              </div>
              <div class="benefits-grid__item">
                <img class="benefits-grid__icon" src="https://cdn.shopify.com/s/files/1/0742/4635/7257/files/icons_34.svg" alt="">
                <div class="benefits-grid__text">Compatible With <strong>All</strong> Cooktops</div>
              </div>
            </div>
          </div>

          <div id="pf-icons" class="pf-wrap">
            <div class="pf-track">
              <div class="pf-item"><div class="pf-icon"><img src="https://cdn.shopify.com/s/files/1/0742/4635/7257/files/icons_3.png?width=80" alt=""></div><div class="pf-text">Lifetime<br>Warranty</div></div>
              <div class="pf-item"><div class="pf-icon"><img src="https://cdn.shopify.com/s/files/1/0742/4635/7257/files/icons_4.png?width=80" alt=""></div><div class="pf-text">Metal<br>Safe</div></div>
              <div class="pf-item"><div class="pf-icon"><img src="https://cdn.shopify.com/s/files/1/0742/4635/7257/files/icons_5.png?width=80" alt=""></div><div class="pf-text">Oven<br>Safe</div></div>
              <div class="pf-item"><div class="pf-icon"><img src="https://cdn.shopify.com/s/files/1/0742/4635/7257/files/icons_6.png?width=80" alt=""></div><div class="pf-text">Dishwasher<br>Safe</div></div>
              <div class="pf-item"><div class="pf-icon"><img src="https://cdn.shopify.com/s/files/1/0742/4635/7257/files/icons_7.png?width=80" alt=""></div><div class="pf-text">No Heavy<br>Metals</div></div>
            </div>
          </div>

          <div class="pb-sizes">
            <div class="pb-sizes-head">
              <label class="pb-label">Select Variant</label>
              <span style="text-decoration:underline; cursor:pointer;">Size Guide</span>
            </div>
            
            <div class="pb-size-tabs">
              {% for variant in product.variants %}
                <button type="button" class="pb-size-tab {% if forloop.first %}is-active{% endif %}" 
                  data-variant-id="{{ variant.id }}" 
                  data-price="{{ variant.price | money }}"
                  data-compare="{{ variant.compare_at_price | money }}"
                  onclick="selectVariant(this)">
                  {{ variant.title }}
                </button>
              {% endfor %}
            </div>
          </div>

          <div class="pb-title">Or Select Bundle & Save</div>
          
          <div class="pb-card is-collapsed" onclick="toggleBundle(this)">
            <span class="pb-badge">Most Popular</span>
            <button type="button" class="pb-head">
              <div class="pb-hleft">
                <div class="pb-name">Everyday Duo (6 Piece)</div>
                <div style="font-size:12px; color:#aaa; margin-top:5px;">Includes Standard & Extra Large Pan</div>
              </div>
              <div class="pb-hright">
                <div class="pb-price">$459</div>
                <div style="font-size:12px; color:#aaa; text-decoration:line-through;">$999</div>
              </div>
            </button>
          </div>

          <div class="pb-card is-collapsed" onclick="toggleBundle(this)">
            <span class="pb-badge">Best Value</span>
            <button type="button" class="pb-head">
              <div class="pb-hleft">
                <div class="pb-name">Titanium Pan Trio (10 Piece)</div>
                <div style="font-size:12px; color:#aaa; margin-top:5px;">Standard, Large & Extra Large</div>
              </div>
              <div class="pb-hright">
                <div class="pb-price">$699</div>
                <div style="font-size:12px; color:#aaa; text-decoration:line-through;">$1499</div>
              </div>
            </button>
          </div>

          {%- form 'product', product, id: 'product-form-installment', class: 'installment caption-large' -%}
            <input type="hidden" name="id" id="RealVariantInput" value="{{ product.selected_or_first_available_variant.id }}">
            <div class="pb-atc-wrap">
              <button type="submit" name="add" class="pb-atc-btn" id="ctm-atc-btn">
                Add To Cart
              </button>
            </div>
          {%- endform -%}

          <div class="shipbar__inner">
            <div class="shipbar__left">
              <div style="font-size:14px; color:#D4C7B4;">Free Shipping</div>
            </div>
            <ul class="shipbar__list">
              <li class="shipbar__item"><img src="https://cdn.shopify.com/s/files/1/0742/4635/7257/files/icons_26.svg" width="20"> 30-Day Guarantee</li>
              <li class="shipbar__item"><img src="https://cdn.shopify.com/s/files/1/0742/4635/7257/files/icons_28.svg" width="20"> Lifetime Warranty</li>
            </ul>
          </div>

          <div class="pit-tabs">
            <button class="pit-tab is-active" onclick="openInfoTab(event, 'tab-1')">Purity Cert.</button>
            <button class="pit-tab" onclick="openInfoTab(event, 'tab-2')">Titanium vs Rest</button>
            <button class="pit-tab" onclick="openInfoTab(event, 'tab-3')">Health Benefits</button>
          </div>
          
          <div id="tab-1" class="pit-panel">
            <p class="product__description" style="color:#B0B0B0;">Every pan is made from Grade 1 Titanium (lab-graded 99.86%) - the absolute purest form available, also known as medical-grade titanium.</p>
          </div>
          <div id="tab-2" class="pit-panel" style="display:none;">
            <p class="product__description" style="color:#B0B0B0;">Comparison details between Titanium and traditional non-stick pans.</p>
          </div>
          <div id="tab-3" class="pit-panel" style="display:none;">
            <p class="product__description" style="color:#B0B0B0;">Retains up to 30% more nutrients. Naturally antibacterial.</p>
          </div>

          <div class="pfaq-item">
            <button class="pfaq-head" onclick="toggleAccordion(this)">
              <span>Details, Care & Use</span>
              <span>+</span>
            </button>
            <div class="pfaq-panel" style="display:none; color:#B0B0B0; padding-bottom:15px;">
              <p>Dishwasher safe. Metal utensil safe. Works on all cooktops including Induction.</p>
            </div>
          </div>
          <div class="pfaq-item">
            <button class="pfaq-head" onclick="toggleAccordion(this)">
              <span>Shipping & Returns</span>
              <span>+</span>
            </button>
            <div class="pfaq-panel" style="display:none; color:#B0B0B0; padding-bottom:15px;">
              <p>Free shipping on orders over $100. 30-Day Money Back Guarantee.</p>
            </div>
          </div>

        </section>
      </div>
    </div>
  </div>

  <div class="sticky-cta" id="sticky-cta">
    <div class="sticky-cta__thumb">
      <img src="{{ product.featured_image | image_url: width: 100 }}" width="50" height="50" style="border-radius:5px;">
    </div>
    <div class="sticky-cta__body">
      <div style="font-weight:600;">{{ product.title }}</div>
      <div style="color:#e23223; font-size:12px;">ALMOST SOLD OUT</div>
    </div>
    <a class="sticky-cta__btn" href="#ctm-atc-btn" onclick="document.getElementById('ctm-atc-btn').scrollIntoView({behavior: 'smooth', block: 'center'}); return false;">ADD TO CART</a>
  </div>

</section>

<script>
  // 1. Variant Selection Logic
  function selectVariant(btn) {
    // Remove active class from all tabs
    document.querySelectorAll('.pb-size-tab').forEach(el => el.classList.remove('is-active'));
    // Add active class to clicked
    btn.classList.add('is-active');
    
    // Update Hidden Input for Form
    const vid = btn.getAttribute('data-variant-id');
    document.getElementById('RealVariantInput').value = vid;
    
    // Update Display Price
    document.querySelector('.ctm-price__current').innerText = btn.getAttribute('data-price');
    document.querySelector('.ctm-price__compare').innerText = btn.getAttribute('data-compare');
  }

  // 2. Bundle Card Toggle
  function toggleBundle(card) {
    // Reset all cards
    document.querySelectorAll('.pb-card').forEach(c => {
        c.classList.add('is-collapsed');
        c.style.backgroundColor = 'transparent';
        c.querySelector('.pb-name').style.color = '#fff';
        c.querySelector('.pb-price').style.color = '#fff';
    });
    
    // Activate clicked card
    card.classList.remove('is-collapsed');
    card.style.backgroundColor = '#F6F4F0';
    card.querySelector('.pb-name').style.color = '#2C1F1C';
    card.querySelector('.pb-price').style.color = '#B57C46';
    
    // NOTE: For bundles to work on checkout, you need specific logic or an app.
    // For now, this is visual styling from the competitor.
  }

  // 3. Tab Switching Logic
  function openInfoTab(evt, tabId) {
    // Hide all panels
    document.querySelectorAll('.pit-panel').forEach(p => p.style.display = 'none');
    // Deactivate tabs
    document.querySelectorAll('.pit-tab').forEach(t => t.classList.remove('is-active'));
    
    // Show target
    document.getElementById(tabId).style.display = 'block';
    evt.currentTarget.classList.add('is-active');
  }

  // 4. Accordion Logic
  function toggleAccordion(btn) {
    const panel = btn.nextElementSibling;
    const isVisible = panel.style.display === 'block';
    panel.style.display = isVisible ? 'none' : 'block';
    btn.querySelector('span:last-child').innerText = isVisible ? '+' : '-';
  }

  // 5. Sticky CTA Scroll Logic
  document.addEventListener('scroll', function() {
    const cta = document.getElementById('sticky-cta');
    const mainBtn = document.getElementById('ctm-atc-btn');
    const rect = mainBtn.getBoundingClientRect();
    
    // Show sticky bar if main button is scrolled out of view (above)
    if (rect.bottom < 0) {
      cta.classList.add('is-visible');
    } else {
      cta.classList.remove('is-visible');
    }
  });
</script>

{% schema %}
{
  "name": "Competitor Main Product",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color Scheme",
      "default": "scheme-1"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding Top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding Bottom",
      "default": 36
    }
  ],
  "blocks": [
    {
      "type": "@app"
    }
  ],
  "presets": [
    {
      "name": "Competitor Main Product"
    }
  ]
}
{% endschema %}
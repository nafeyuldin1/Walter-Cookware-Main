<section id="MainProduct-{{ section.id }}" class="section-{{ section.id }}-padding gradient color-{{ section.settings.color_scheme }}" data-section="{{ section.id }}">
  {{ 'section-main-product.css' | asset_url | stylesheet_tag }}
  {{ 'component-price.css' | asset_url | stylesheet_tag }}
  {{ 'component-loading-spinner.css' | asset_url | stylesheet_tag }}

  {%- style -%}
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
      padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
      background-color: #121212 !important; color: #ffffff !important;
    }
    .product__title, .product__title h1 { color: #ffffff !important; }
    .benefits-grid { margin: 20px 0; border-top: 1px solid #333; padding-top: 20px; }
    .benefits-grid__list { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .pit-tabs { display: flex; border-bottom: 1px solid #454545; margin: 20px 0; }
    .pit-tab { flex: 1; padding: 15px; background: transparent; border: none; color: #B0B0B0; cursor: pointer; border-bottom: 2px solid transparent; }
    .pit-tab.is-active { color: #fff; border-bottom-color: #fff; }
    .pit-panel { display: none; color: #B0B0B0; padding: 15px 0; }
    .pit-panel.is-active { display: block; }
    .sticky-cta { position: fixed; z-index: 99; bottom: 20px; right: 20px; background: #1a1a1a; padding: 10px; border-radius: 12px; display: flex; align-items: center; gap: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); transform: translateY(200%); transition: transform 0.3s ease; border: 1px solid #333; }
    .sticky-cta.is-visible { transform: translateY(0); }
    .sticky-cta button { background: #fff; color: #000; border: none; padding: 10px 20px; font-weight: bold; border-radius: 6px; cursor: pointer; }
  {%- endstyle -%}

  <div class="page-width">
    <div class="product grid grid--1-col grid--2-col-tablet">
      <div class="grid__item product__media-wrapper">
        {% render 'product-media-gallery' %}
      </div>
      <div class="product__info-wrapper grid__item">
        <product-info id="ProductInfo-{{ section.id }}" data-section="{{ section.id }}" data-url="{{ product.url }}">
          {%- assign product_form_id = 'product-form-' | append: section.id -%}
          {%- for block in section.blocks -%}
            {%- case block.type -%}
              {%- when 'title' -%}<h1 class="product__title">{{ product.title | escape }}</h1>
              {%- when 'price' -%}
                <div id="price-{{ section.id }}">{% render 'price', product: product, use_variant: true, show_badges: true %}</div>
              {%- when 'variant_picker' -%}
                {% render 'product-variant-picker', product: product, block: block, product_form_id: product_form_id %}
              {%- when 'buy_buttons' -%}
                {% render 'buy-buttons', block: block, product: product, product_form_id: product_form_id, section_id: section.id %}
            {%- endcase -%}
          {%- endfor -%}

          <div class="pit-container">
            <div class="pit-tabs">
              <button class="pit-tab is-active" data-target="panel-desc">Description</button>
              <button class="pit-tab" data-target="panel-health">Health</button>
            </div>
            <div id="panel-desc" class="pit-panel is-active">{{ product.description }}</div>
            <div id="panel-health" class="pit-panel">Titanium Benefits info here.</div>
          </div>
        </product-info>
      </div>
    </div>
  </div>
</section>

<div id="sticky-cta-wrapper" class="sticky-cta">
  <img src="{{ product.featured_image | image_url: width: 100 }}" width="50" height="50">
  <div style="color:#fff;">
    <div style="font-weight:bold; font-size:14px;">{{ product.title | truncate: 15 }}</div>
    <div style="color:#ff2422; font-size:11px;">⚠️ LOW STOCK</div>
  </div>
  <button id="sticky-atc-js">ADD TO CART</button>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const stickyBtn = document.getElementById('sticky-atc-js');
  const mainAtc = document.querySelector('.product-form__submit');
  
  if(stickyBtn && mainAtc) {
    stickyBtn.addEventListener('click', () => mainAtc.click());
  }

  window.addEventListener('scroll', () => {
    const cta = document.getElementById('sticky-cta-wrapper');
    if(mainAtc && cta) {
      if(mainAtc.getBoundingClientRect().bottom < 0) cta.classList.add('is-visible');
      else cta.classList.remove('is-visible');
    }
  });

  document.querySelectorAll('.pit-tab').forEach(tab => {
    tab.addEventListener('click', () => {
      document.querySelectorAll('.pit-tab, .pit-panel').forEach(el => el.classList.remove('is-active'));
      tab.classList.add('is-active');
      document.getElementById(tab.dataset.target).classList.add('is-active');
    });
  });
});
</script>

{% schema %}
{
  "name": "Product Complete",
  "tag": "section",
  "blocks": [
    {"type": "title", "name": "Title", "limit": 1},
    {"type": "price", "name": "Price", "limit": 1},
    {"type": "variant_picker", "name": "Variant Picker", "limit": 1},
    {"type": "buy_buttons", "name": "Buy Buttons", "limit": 1}
  ],
  "settings": [
    {"type": "range", "id": "padding_top", "min": 0, "max": 100, "step": 4, "unit": "px", "label": "Top Padding", "default": 36},
    {"type": "range", "id": "padding_bottom", "min": 0, "max": 100, "step": 4, "unit": "px", "label": "Bottom Padding", "default": 36}
  ]
}
{% endschema %}
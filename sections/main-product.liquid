<section id="MainProduct-{{ section.id }}" class="section-{{ section.id }}-padding gradient custom_bg_black_gradient" data-section="{{ section.id }}">
  
  {{ 'section-main-product.css' | asset_url | stylesheet_tag }}
  {{ 'component-accordion.css' | asset_url | stylesheet_tag }}
  {{ 'component-price.css' | asset_url | stylesheet_tag }}
  {{ 'component-slider.css' | asset_url | stylesheet_tag }}
  {{ 'component-rating.css' | asset_url | stylesheet_tag }}
  {{ 'component-deferred-media.css' | asset_url | stylesheet_tag }}

  {%- style -%}
    /* Professional Senior Engineer Grade Styling */
    :root {
      --taima-green: #03231A;
      --taima-gold: #B57C46;
      --taima-text-gray: #B0B0B0;
      --taima-off-white: #E9E2D8;
    }

    .custom_bg_black_gradient {
      background: linear-gradient(90deg,#3b3e41,#181a1b) !important;
    }

    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
      padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
    }

    @media screen and (min-width: 750px) {
      .section-{{ section.id }}-padding {
        padding-top: {{ section.settings.padding_top }}px;
        padding-bottom: {{ section.settings.padding_bottom }}px;
      }
      .product--thumbnail_slider .product__media-wrapper { max-width: 50%; }
      .product--thumbnail_slider .product__info-wrapper { max-width: 50%; padding-left: 5rem; }
    }

    /* Neue Montreal Typeface Fallbacks */
    .product__title h1, .custom_title, .pb-atc-btn, .pit-tab {
      font-family: 'Neue Montreal', sans-serif;
      letter-spacing: 0.04em;
      text-transform: capitalize;
    }

    /* Missing Styling from Competitor */
    .ctm-price__save {
      background: #097350;
      color: var(--taima-off-white);
      padding: 5px 16px;
      border-radius: 32px;
      font-size: 1.4rem;
      font-weight: 500;
    }

    .benefits-grid__item {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 1rem;
    }

    /* Shipping Promise Bar */
    .shipbar__inner {
      background: var(--taima-green);
      border-radius: 12px;
      display: flex;
      overflow: hidden;
      margin: 2rem 0;
    }

    .shipbar__left {
      padding: 15px 25px;
      border-right: 1px solid rgba(255,255,255,0.1);
      min-width: 120px;
    }

    /* Bundles Logic CSS */
    .pb-card {
      border: 1.5px solid var(--taima-off-white);
      border-radius: 12px;
      margin-bottom: 1.5rem;
      padding: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .pb-card.is-active { background: #F6F4F0; color: #121212; }
    .pb-card.is-active .pb-price { color: var(--taima-gold); }
    
    .pb-includes-clip {
      overflow: hidden;
      height: 0;
      transition: height 0.4s ease;
    }
    .pb-card.is-active .pb-includes-clip { height: auto; padding-top: 15px; }

    /* Sticky CTA */
    .sticky-cta-mobile {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #fff;
      z-index: 100;
      padding: 15px;
      box-shadow: 0 -5px 15px rgba(0,0,0,0.2);
      display: none;
    }
    @media (max-width: 749px) {
      .sticky-cta-mobile.is-visible { display: block; }
    }
  {%- endstyle -%}

  <div class="page-width">
    <div class="product grid grid--1-col grid--2-col-tablet">
      <div class="grid__item product__media-wrapper">
        {% render 'product-media-gallery', variant_images: variant_images %}
      </div>

      <div class="product__info-wrapper grid__item">
        <product-info id="ProductInfo-{{ section.id }}" class="product__info-container">
          
          {%- for block in section.blocks -%}
            {%- case block.type -%}
              
              {%- when 'text' -%}
                <p class="product__text inline-richtext" {{ block.shopify_attributes }} style="color: var(--taima-text-gray); margin-bottom: 10px;">
                  {{ block.settings.text }}
                </p>

              {%- when 'title' -%}
                <h1 class="product__title" {{ block.shopify_attributes }} style="font-size: 3.2rem; color: #fff;">
                  {{ product.title | escape }}
                </h1>

              {%- when 'rating' -%}
                <div class="rating-wrapper" {{ block.shopify_attributes }}>
                   {% comment %} Loox or standard rating integration {% endcomment %}
                   <div class="loox-rating" data-id="{{ product.id }}" data-rating="{{ product.metafields.reviews.rating.value }}"></div>
                </div>

              {%- when 'price' -%}
                <div class="price-container" {{ block.shopify_attributes }}>
                   <div class="ctm-price__row" style="display:flex; align-items:center; gap:15px; margin: 15px 0;">
                      <span class="price-item" style="font-size: 4rem; color: var(--taima-off-white);">{{ product.selected_or_first_available_variant.price | money_without_trailing_zeros }}</span>
                      {%- if product.selected_or_first_available_variant.compare_at_price > product.price -%}
                        <s style="font-size: 3rem; color: var(--taima-text-gray);">{{ product.selected_or_first_available_variant.compare_at_price | money_without_trailing_zeros }}</s>
                        <span class="ctm-price__save">SALE ENDS SOON!</span>
                      {%- endif -%}
                   </div>
                </div>

              {%- when 'benefits_grid' -%}
                <div class="benefits-grid" {{ block.shopify_attributes }}>
                  <div class="benefits-grid__list" style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                    <div class="benefits-grid__item">
                      <img src="https://taimatitanium.com/cdn/shop/files/icons_31.svg" width="24" height="24">
                      <div class="benefits-grid__text">No PFAS/PFOA. <strong>No hormone disruptors.</strong></div>
                    </div>
                    <div class="benefits-grid__item">
                      <img src="https://taimatitanium.com/cdn/shop/files/icons_32.svg" width="24" height="24">
                      <div class="benefits-grid__text">Heat Resistant up to <strong>600Â°C</strong></div>
                    </div>
                  </div>
                </div>

              {%- when 'bundles' -%}
                <div class="product-bundles-wrapper" {{ block.shopify_attributes }}>
                   <div class="pb-sizes">
                     <div class="pb-sizes-head" style="display:flex; justify-content:space-between; margin-bottom:10px;">
                        <label class="pb-label" style="font-weight:500;">Select Size Variant</label>
                        <a class="size-guide-trigger" style="text-decoration:underline; cursor:pointer; color: #fff;">Size Guide</a>
                     </div>
                     <div class="pb-size-tabs" style="display:grid; grid-template-columns: repeat(4, 1fr); border: 1px solid #454545; border-radius:12px; overflow:hidden;">
                        {%- for variant in product.variants -%}
                          <button type="button" class="pb-size-tab {% if forloop.first %}is-active{% endif %}" 
                                  data-vid="{{ variant.id }}" 
                                  style="padding:15px; background:transparent; color:#fff; border:none; cursor:pointer; border-right: 1px solid #454545;">
                            {{ variant.title }}
                          </button>
                        {%- endfor -%}
                     </div>
                   </div>

                   <div class="pb-title" style="margin: 20px 0 10px; font-weight:500;">Or Select Bundle & Save</div>
                   <div class="pb-card" data-vid="YOUR_BUNDLE_ID">
                      <div class="pb-head" style="display:flex; justify-content:space-between;">
                         <div class="pb-hleft">
                            <div class="pb-name" style="font-weight:600;">Everyday Duo (6 Piece)</div>
                            <div class="pb-desc" style="font-size:1.2rem; color:var(--taima-text-gray);">Includes 2 Pans + Spatula + FREE Lids</div>
                         </div>
                         <div class="pb-hright" style="text-align:right;">
                            <div class="pb-price" style="font-size:1.8rem;">$459</div>
                            <div class="pb-value" style="font-size:1.2rem; color:var(--taima-text-gray);">($999 Value)</div>
                         </div>
                      </div>
                      <div class="pb-includes-clip">
                         <div style="display:flex; gap:5px; margin-top:10px;">
                            {% comment %} Add small images for bundle items here {% endcomment %}
                            <div style="width:50px; height:50px; background:#eee; border-radius:4px;"></div>
                            <div style="width:50px; height:50px; background:#eee; border-radius:4px;"></div>
                         </div>
                      </div>
                   </div>
                </div>

              {%- when 'buy_buttons' -%}
                {%- render 'buy-buttons', block: block, product: product, product_form_id: product_form_id, section_id: section.id -%}

              {%- when 'shipping_promise' -%}
                <div class="shipbar" {{ block.shopify_attributes }}>
                   <div class="shipbar__left">
                      <div style="color:var(--taima-gold); font-size:1.2rem;">Ships By</div>
                      <div style="font-size:1.8rem; font-weight:600;">{{ "now" | date: "%s" | plus: 172800 | date: "%b %d" }}</div>
                   </div>
                   <div class="shipbar__right" style="padding: 10px 20px; display:flex; align-items:center; gap:10px;">
                      <img src="https://taimatitanium.com/cdn/shop/files/icons_26.svg" width="20">
                      <span style="font-size:1.2rem; color: var(--taima-off-white);">FREE Shipping & 30-Day Guarantee</span>
                   </div>
                </div>

              {%- when 'tabs' -%}
                <div class="pit-container" {{ block.shopify_attributes }}>
                   <div class="pit-tabs">
                      <button class="pit-tab is-active" data-target="health-panel">Health Benefits</button>
                      <button class="pit-tab" data-target="purity-panel">Purity Cert.</button>
                      <button class="pit-tab" data-target="care-panel">Care & Use</button>
                   </div>
                   <div id="health-panel" class="pit-panel is-active">
                      <ul style="list-style:none; padding:0;">
                        <li style="margin-bottom:15px;"><strong>99.86% Pure Titanium</strong> - Safest metal for human body contact.</li>
                        <li style="margin-bottom:15px;"><strong>Toxin-Free Surface</strong> - No PFAS, lead, or hormone disruptors.</li>
                      </ul>
                      <div class="hb-extra-content" id="hb-reveal" style="display:none;">
                         <p>Retains up to 30% more nutrients due to superior heat conductivity...</p>
                      </div>
                      <button id="hb-toggle-btn" style="width:100%; background:none; border:1px solid #fff; color:#fff; padding:10px; border-radius:8px; margin-top:10px; cursor:pointer;">Show More</button>
                   </div>
                   <div id="purity-panel" class="pit-panel">
                      <p>Tested by SGS Labs. Grade 1 Medical Grade Titanium.</p>
                   </div>
                   <div id="care-panel" class="pit-panel">
                      <p>Dishwasher safe. Metal utensil safe. Induction compatible.</p>
                   </div>
                </div>

              {%- when 'payment_icons' -%}
                <div class="secure-checkout" style="margin: 20px 0; text-align:center;">
                   <div style="font-size:1.2rem; color:var(--taima-text-gray); margin-bottom:10px;">Guaranteed Safe & Secure Checkout</div>
                   <div class="pay-badges" style="display:flex; justify-content:center; gap:10px; flex-wrap:wrap;">
                      {% comment %} Add your specific payment image assets here {% endcomment %}
                      <img src="https://taimatitanium.com/cdn/shop/files/Container_7.png" width="35">
                      <img src="https://taimatitanium.com/cdn/shop/files/Container_6.png" width="35">
                      <img src="https://taimatitanium.com/cdn/shop/files/Container_5.png" width="35">
                   </div>
                </div>

            {%- endcase -%}
          {%- endfor -%}

        </product-info>
      </div>
    </div>
  </div>

  {% comment %} Modals & Sticky UI {% endcomment %}
  <div id="sg-modal" class="sg-modal" hidden>
    <div class="sg-panel">
      <header style="display:flex; justify-content:space-between; align-items:center;">
        <h2 style="margin:0;">Size Guide</h2>
        <button class="sg-close">&times;</button>
      </header>
      <div class="unit-toggle" style="margin: 15px 0;">
         <span id="unit-in" style="font-weight:bold;">In</span> / <span id="unit-cm">Cm</span>
      </div>
      <table class="sg-table" style="width:100%; margin-top:20px; border-collapse:collapse;">
        <thead><tr style="background:#f9f9f9;"><th>Size</th><th id="dim-label">Diameter</th></tr></thead>
        <tbody id="sg-tbody">
          <tr><td>Standard</td><td class="dim-val" data-in='10.2"' data-cm="26cm">10.2"</td></tr>
          <tr><td>Large</td><td class="dim-val" data-in='11.8"' data-cm="30cm">11.8"</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="sticky-cta-mobile" id="sticky-atc">
     <button class="button button--full-width button--primary" onclick="document.querySelector('.product-form__submit').click()">ADD TO CART</button>
  </div>

</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // 1. Tab Switching Logic
  const tabs = document.querySelectorAll('.pit-tab');
  const panels = document.querySelectorAll('.pit-panel');
  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      tabs.forEach(t => t.classList.remove('is-active'));
      panels.forEach(p => p.classList.remove('is-active'));
      tab.classList.add('is-active');
      document.getElementById(tab.dataset.target).classList.add('is-active');
    });
  });

  // 2. Health Benefits "Show More"
  const hbBtn = document.getElementById('hb-toggle-btn');
  const hbReveal = document.getElementById('hb-reveal');
  if(hbBtn) {
    hbBtn.addEventListener('click', () => {
      const isHidden = hbReveal.style.display === 'none';
      hbReveal.style.display = isHidden ? 'block' : 'none';
      hbBtn.textContent = isHidden ? 'Show Less' : 'Show More';
    });
  }

  // 3. Size Guide Modal & Unit Toggle
  const sgModal = document.getElementById('sg-modal');
  document.querySelector('.size-guide-trigger')?.addEventListener('click', () => sgModal.hidden = false);
  document.querySelector('.sg-close')?.addEventListener('click', () => sgModal.hidden = true);
  
  const unitCm = document.getElementById('unit-cm');
  const unitIn = document.getElementById('unit-in');
  const dims = document.querySelectorAll('.dim-val');

  unitCm?.addEventListener('click', () => {
    unitCm.style.fontWeight = 'bold'; unitIn.style.fontWeight = 'normal';
    dims.forEach(d => d.textContent = d.dataset.cm);
  });
  unitIn?.addEventListener('click', () => {
    unitIn.style.fontWeight = 'bold'; unitCm.style.fontWeight = 'normal';
    dims.forEach(d => d.textContent = d.dataset.in);
  });

  // 4. Bundle Selection logic
  const bundleCards = document.querySelectorAll('.pb-card');
  const sizeTabs = document.querySelectorAll('.pb-size-tab');
  
  bundleCards.forEach(card => {
    card.addEventListener('click', () => {
      bundleCards.forEach(c => c.classList.remove('is-active'));
      sizeTabs.forEach(t => t.classList.remove('is-active'));
      card.classList.add('is-active');
      // Update hidden variant input
      const variantId = card.dataset.vid;
      document.querySelector('input[name="id"]').value = variantId;
    });
  });

  // 5. Sticky Mobile ATC Visibility
  window.addEventListener('scroll', () => {
    const mainAtc = document.querySelector('.product-form__submit');
    const stickyAtc = document.getElementById('sticky-atc');
    if(mainAtc && stickyAtc) {
      if(mainAtc.getBoundingClientRect().bottom < 0) stickyAtc.classList.add('is-visible');
      else stickyAtc.classList.remove('is-visible');
    }
  });
});
</script>

{% schema %}
{
  "name": "Professional Product Page",
  "tag": "section",
  "blocks": [
    { "type": "@app" },
    { "type": "text", "name": "Text", "settings": [{ "type": "inline_richtext", "id": "text", "label": "Text" }] },
    { "type": "title", "name": "Title", "limit": 1 },
    { "type": "price", "name": "Price", "limit": 1 },
    { "type": "benefits_grid", "name": "Benefits Grid", "limit": 1 },
    { "type": "bundles", "name": "Product Bundles", "limit": 1 },
    { "type": "buy_buttons", "name": "Buy Buttons", "limit": 1 },
    { "type": "shipping_promise", "name": "Shipping Promise", "limit": 1 },
    { "type": "tabs", "name": "Product Info Tabs", "limit": 1 },
    { "type": "payment_icons", "name": "Payment Icons", "limit": 1 },
    { "type": "rating", "name": "Rating", "limit": 1 }
  ],
  "settings": [
    { "type": "range", "id": "padding_top", "min": 0, "max": 100, "step": 4, "unit": "px", "label": "Top Padding", "default": 36 },
    { "type": "range", "id": "padding_bottom", "min": 0, "max": 100, "step": 4, "unit": "px", "label": "Bottom Padding", "default": 36 }
  ]
}
{% endschema %}
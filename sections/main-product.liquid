{{ 'section-main-product.css' | asset_url | stylesheet_tag }}
{{ 'component-accordion.css' | asset_url | stylesheet_tag }}
{{ 'component-price.css' | asset_url | stylesheet_tag }}
{{ 'component-slider.css' | asset_url | stylesheet_tag }}
{{ 'component-rating.css' | asset_url | stylesheet_tag }}
{{ 'component-loading-spinner.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }

  /* --- Global Styles --- */
  #MainProduct-{{ section.id }} {
    background: {{ section.settings.bg_gradient | default: '#121212' }};
    color: {{ section.settings.text_color }};
  }

  #MainProduct-{{ section.id }} h1, 
  #MainProduct-{{ section.id }} h2, 
  #MainProduct-{{ section.id }} h3,
  #MainProduct-{{ section.id }} .product__title {
    color: {{ section.settings.title_color }};
    font-family: 'Neue Montreal', sans-serif, var(--font-heading-family);
    margin-top: 0;
  }

  /* --- Price Styling --- */
  .ctm-price__row { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; margin-bottom: 15px; }
  .ctm-price__current { font-size: 32px; font-weight: 500; color: {{ section.settings.price_color }}; line-height: 1.2; }
  .ctm-price__compare { font-size: 24px; text-decoration: line-through; color: {{ section.settings.compare_price_color }}; opacity: 0.7; }
  .ctm-price__save { 
    background: {{ section.settings.sale_badge_bg }}; 
    color: {{ section.settings.sale_badge_text }}; 
    padding: 6px 14px; border-radius: 30px; font-size: 14px; font-weight: 600; text-transform: uppercase;
  }

  /* --- BUNDLE WIDGET --- */
  .pb-wrap { margin: 24px 0; color: inherit; }
  
  /* Size Tabs */
  .pb-sizes-head { display: flex; justify-content: space-between; margin-bottom: 12px; font-weight: 500; font-size: 16px; }
  .sbp-size-guide { text-decoration: underline; opacity: 0.9; cursor: pointer; font-size: 14px; }
  
  .pb-size-tabs { 
    display: flex; /* Changed from Grid to Flex to prevent empty columns */
    border: 1px solid {{ section.settings.bundle_border_color }}; 
    border-radius: 8px; 
    overflow: hidden; 
  }
  .pb-size-tab { 
    flex: 1;
    padding: 14px 4px; text-align: center; cursor: pointer; background: transparent; 
    color: {{ section.settings.text_color }}; border-right: 1px solid {{ section.settings.bundle_border_color }}; 
    font-size: 14px; opacity: 0.7; transition: all 0.2s; font-weight: 500;
  }
  .pb-size-tab:last-child { border-right: none; }
  .pb-size-tab:hover { opacity: 1; background: rgba(255,255,255,0.05); }
  .pb-size-tab.is-active { background: {{ section.settings.bundle_active_bg }}; color: #121212; opacity: 1; font-weight: 700; }

  /* Bundle Cards */
  .pb-title { margin-top: 24px; margin-bottom: 12px; font-size: 16px; font-weight: 500; }
  .pb-card { 
    border: 1px solid {{ section.settings.bundle_border_color }}; 
    border-radius: 12px; margin-bottom: 12px; padding: 16px; 
    position: relative; cursor: pointer; transition: all 0.3s ease;
    display: flex; justify-content: space-between; align-items: center;
  }
  .pb-card:hover { border-color: {{ section.settings.bundle_active_bg }}; }
  .pb-card.is-active { background: {{ section.settings.bundle_active_bg }}; color: #121212; border-color: transparent; }
  
  .pb-badge { 
    position: absolute; top: -1px; right: -1px; 
    background: #BCA588; color: #121212; 
    font-size: 10px; text-transform: uppercase; font-weight: 700; letter-spacing: 0.5px;
    padding: 4px 10px; border-radius: 0 12px 0 12px; z-index: 2;
  }
  
  .pb-left { flex: 1; }
  .pb-name { font-weight: 600; font-size: 15px; margin-bottom: 6px; display: block;}
  .pb-desc { font-size: 12px; opacity: 0.8; line-height: 1.4; display: block; max-width: 90%; }
  .pb-card.is-active .pb-desc { opacity: 0.9; }
  
  .pb-price-wrap { text-align: right; min-width: 90px; display: flex; flex-direction: column; align-items: flex-end; }
  .pb-price { font-weight: 600; font-size: 18px; color: #B57C46; }
  .pb-card.is-active .pb-price { color: #8B4513; }
  .pb-val { font-size: 12px; opacity: 0.6; text-decoration: line-through; margin-top: 2px; }

  /* Quantity & ATC */
  .qty-atc-wrapper { display: flex; gap: 10px; margin-top: 24px; align-items: stretch; height: 50px; }
  
  .product-form__quantity { 
    width: 90px; min-width: 90px; margin: 0; background: rgba(255,255,255,0.1); 
    border-radius: 8px; border: 1px solid rgba(255,255,255,0.2);
  }
  .quantity { width: 100%; height: 100%; display: flex; align-items: center; justify-content: space-between; }
  .quantity__input { color: inherit; background: transparent; border: none; text-align: center; width: 100%; font-weight: bold; appearance: none; -moz-appearance: textfield; }
  .quantity__input::-webkit-outer-spin-button, .quantity__input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
  .quantity__button { color: inherit; background: transparent; border: none; cursor: pointer; width: 30px; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 18px; }
  
  .pb-atc-btn {
    flex: 1;
    background: {{ section.settings.atc_bg }};
    color: {{ section.settings.atc_text }};
    border: none; border-radius: 8px; font-size: 16px; font-weight: 700; letter-spacing: 0.5px;
    cursor: pointer; text-transform: uppercase; transition: opacity 0.2s;
    display: flex; justify-content: center; align-items: center; gap: 10px;
  }
  .pb-atc-btn:hover { opacity: 0.9; }

  /* Utilities */
  .no-js-hidden.variant-picker-hidden { display: none; }
  .benefits-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin: 20px 0; }
  .benefits-item { display: flex; align-items: center; gap: 10px; font-size: 13px; color: #B0B0B0; }
  .benefits-item img { width: 24px; height: 24px; }
  .benefits-item strong { color: #fff; font-weight: 500; }
  
  /* Secure Badge */
  .secure-checkout { text-align: center; margin-top: 15px; opacity: 0.8; font-size: 12px; }
  .pay-badges { margin-top: 8px; display: flex; justify-content: center; gap: 5px; }
  .pay-badges svg { width: 38px; height: 24px; border-radius: 4px; }

  /* Sticky ATC */
  .sticky-atc {
    position: fixed; bottom: 20px; right: 20px; z-index: 99;
    background: #1a1a1a; color: #fff; padding: 12px; border-radius: 10px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5); display: flex; gap: 15px; align-items: center;
    transform: translateY(200%); transition: transform 0.4s cubic-bezier(0.25, 1, 0.5, 1);
    max-width: 400px;
  }
  .sticky-atc.is-visible { transform: translateY(0); }
  .sticky-img { width: 60px; height: 60px; border-radius: 6px; object-fit: cover; }
  .sticky-info { font-size: 13px; line-height: 1.2; }
  .sticky-title { font-weight: bold; margin-bottom: 2px; }
  .sticky-alert { color: #e23223; font-weight: bold; font-size: 11px; text-transform: uppercase; }
  .sticky-btn { background: #fff; color: #000; border: none; padding: 8px 16px; border-radius: 6px; font-weight: bold; cursor: pointer; text-decoration: none; font-size: 13px;}

  @media screen and (max-width: 749px) {
    .sticky-atc { left: 0; right: 0; bottom: 0; border-radius: 0; width: 100%; max-width: 100%; justify-content: space-between; padding: 15px; }
    .sticky-img, .sticky-info { display: none; }
    .sticky-btn { width: 100%; padding: 15px; font-size: 16px; }
  }

{%- endstyle -%}

<script src="{{ 'product-info.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'product-form.js' | asset_url }}" defer="defer"></script>

<section id="MainProduct-{{ section.id }}" class="section-{{ section.id }}-padding" data-section="{{ section.id }}">
  <div class="page-width">
    <div class="product product--{{ section.settings.media_size }} product--{{ section.settings.media_position }} product--{{ section.settings.gallery_layout }} grid grid--1-col {% if product.media.size > 0 %}grid--2-col-tablet{% else %}product--no-media{% endif %}">
      
      <div class="grid__item product__media-wrapper">
        {% render 'product-media-gallery', variant_images: variant_images, limit: 10 %}
      </div>

      <div class="product__info-wrapper grid__item">
        <product-info id="ProductInfo-{{ section.id }}" class="product__info-container{% if section.settings.enable_sticky_info %} product__column-sticky{% endif %}">
          
          {%- assign product_form_id = 'product-form-' | append: section.id -%}

          {%- for block in section.blocks -%}
            {%- case block.type -%}
              
              {%- when '@app' -%}
                {% render block %}

              {%- when 'text' -%}
                <p class="product__text inline-richtext" style="color: {{ block.settings.color }}; margin-bottom: {{ block.settings.margin_bottom }}px; text-transform: {{ block.settings.text_style }}; font-weight: 500; letter-spacing: 0.5px;" {{ block.shopify_attributes }}>
                  {{ block.settings.text }}
                </p>

              {%- when 'title' -%}
                <h1 class="product__title" {{ block.shopify_attributes }}>{{ product.title | escape }}</h1>

              {%- when 'trust_badge' -%}
                <div style="margin-bottom: 20px;">
                  <div style="display: flex; gap: 5px; align-items: center; font-size: 14px; color: #fff;">
                    <span style="color: #00b67a;">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span> 
                    <span>4.9/5.0 Rated by 500+ Chefs</span>
                  </div>
                </div>

              {%- when 'price' -%}
                <div class="no-js-hidden" id="price-{{ section.id }}" role="status" {{ block.shopify_attributes }}>
                  {%- if block.settings.show_description -%}
                    <div class="description_ctm" style="margin-bottom: 20px; opacity: 0.8; font-size: 15px; line-height: 1.5;">{{ product.description | strip_html | truncatewords: 30 }}</div>
                  {%- endif -%}
                  
                  <div class="price-wrapper">
                    <div class="ctm-price__row">
                      <span class="ctm-price__current">{{ product.selected_or_first_available_variant.price | money }}</span>
                      <s class="ctm-price__compare">
                        {% if product.selected_or_first_available_variant.compare_at_price > product.selected_or_first_available_variant.price %}
                          {{ product.selected_or_first_available_variant.compare_at_price | money }}
                        {% endif %}
                      </s>
                      {% if product.selected_or_first_available_variant.compare_at_price > product.selected_or_first_available_variant.price %}
                        <span class="ctm-price__save">{{ block.settings.sale_badge_text }}</span>
                      {% endif %}
                    </div>
                  </div>
                </div>

              {%- when 'benefits_grid' -%}
                <div class="benefits-grid" {{ block.shopify_attributes }}>
                  {% for i in (1..4) %}
                    {% capture icon_key %}icon_{{ i }}{% endcapture %}
                    {% capture text_key %}text_{{ i }}{% endcapture %}
                    {% if block.settings[text_key] != blank %}
                      <div class="benefits-item">
                        {% if block.settings[icon_key] != blank %}
                          <img src="{{ block.settings[icon_key] | image_url: width: 48 }}" loading="lazy">
                        {% else %}
                          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                        {% endif %}
                        <span>{{ block.settings[text_key] }}</span>
                      </div>
                    {% endif %}
                  {% endfor %}
                </div>

              {%- when 'bundle_widget' -%}
                <bundle-widget class="pb-wrap" data-section="{{ section.id }}" {{ block.shopify_attributes }}>
                  
                  {%- unless product.has_only_default_variant -%}
                    <div class="pb-sizes">
                      <div class="pb-sizes-head">
                        <label class="pb-label">{{ block.settings.size_label }}</label>
                        <span class="sbp-size-guide">{{ block.settings.size_guide_text }}</span>
                      </div>
                      <div class="pb-size-tabs">
                        {%- assign main_option = product.options_with_values[0] -%}
                        {%- for value in main_option.values -%}
                          {%- assign variant_match = product.variants | where: main_option.name, value | first -%}
                          
                          <div class="pb-size-tab {% if product.selected_or_first_available_variant.option1 == value %}is-active{% endif %}"
                               data-variant-id="{{ variant_match.id }}"
                               data-price="{{ variant_match.price | money }}"
                               data-compare="{{ variant_match.compare_at_price | money }}"
                               data-type="variant">
                            {{ value }}
                          </div>
                        {%- endfor -%}
                      </div>
                    </div>
                  {%- endunless -%}

                  {% if block.settings.show_bundles %}
                    <div class="pb-title">Or Select Bundle & Save</div>
                    
                    {% if block.settings.bundle_1_product != blank %}
                      {% assign b1 = block.settings.bundle_1_product %}
                      <div class="pb-card" data-variant-id="{{ b1.selected_or_first_available_variant.id }}" data-price="{{ b1.price | money }}" data-compare="{{ b1.compare_at_price | money }}" data-type="bundle">
                        <span class="pb-badge">Most Popular</span>
                        <div class="pb-left">
                          <span class="pb-name">{{ b1.title }}</span>
                          <span class="pb-desc">{{ block.settings.bundle_1_desc }}</span>
                        </div>
                        <div class="pb-price-wrap">
                          <span class="pb-price">{{ b1.price | money }}</span>
                          <span class="pb-val">{{ b1.compare_at_price | money }}</span>
                        </div>
                      </div>
                    {% endif %}

                    {% if block.settings.bundle_2_product != blank %}
                      {% assign b2 = block.settings.bundle_2_product %}
                      <div class="pb-card" data-variant-id="{{ b2.selected_or_first_available_variant.id }}" data-price="{{ b2.price | money }}" data-compare="{{ b2.compare_at_price | money }}" data-type="bundle">
                        <span class="pb-badge">Great Value</span>
                        <div class="pb-left">
                          <span class="pb-name">{{ b2.title }}</span>
                          <span class="pb-desc">{{ block.settings.bundle_2_desc }}</span>
                        </div>
                        <div class="pb-price-wrap">
                          <span class="pb-price">{{ b2.price | money }}</span>
                          <span class="pb-val">{{ b2.compare_at_price | money }}</span>
                        </div>
                      </div>
                    {% endif %}

                    {% if block.settings.bundle_3_product != blank %}
                      {% assign b3 = block.settings.bundle_3_product %}
                      <div class="pb-card" data-variant-id="{{ b3.selected_or_first_available_variant.id }}" data-price="{{ b3.price | money }}" data-compare="{{ b3.compare_at_price | money }}" data-type="bundle">
                        <span class="pb-badge">Limited Offer</span>
                        <div class="pb-left">
                          <span class="pb-name">{{ b3.title }}</span>
                          <span class="pb-desc">{{ block.settings.bundle_3_desc }}</span>
                        </div>
                        <div class="pb-price-wrap">
                          <span class="pb-price">{{ b3.price | money }}</span>
                          <span class="pb-val">{{ b3.compare_at_price | money }}</span>
                        </div>
                      </div>
                    {% endif %}
                  {% endif %}

                  <div class="qty-atc-wrapper">
                    <div class="product-form__quantity">
                        <quantity-input class="quantity">
                          <button class="quantity__button no-js-hidden" name="minus" type="button">-</button>
                          <input class="quantity__input" type="number" name="quantity" min="1" value="1" form="{{ product_form_id }}">
                          <button class="quantity__button no-js-hidden" name="plus" type="button">+</button>
                        </quantity-input>
                    </div>

                    <product-form class="product-form" style="flex:1;">
                      <div class="product-form__error-message-wrapper" role="alert" hidden></div>
                      <form method="post" action="/cart/add" id="{{ product_form_id }}" class="form" enctype="multipart/form-data" novalidate="novalidate">
                        <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}" class="product-variant-id">
                        <button type="submit" name="add" class="pb-atc-btn">
                          <span>Add to Cart - <span class="atc-price">{{ product.selected_or_first_available_variant.price | money }}</span></span>
                        </button>
                      </form>
                    </product-form>
                  </div>

                  <div class="secure-checkout">
                    <div class="secure-note">üîí {{ block.settings.guarantee_text }}</div>
                    <div class="pay-badges">
                      {% for type in shop.enabled_payment_types %}
                        {{ type | payment_type_svg_tag: class: 'icon icon--full-color' }}
                      {% endfor %}
                    </div>
                  </div>

                </bundle-widget>

                <div class="no-js-hidden variant-picker-hidden">
                  {% render 'product-variant-picker', product: product, block: block, product_form_id: product_form_id %}
                </div>

              {%- when 'shipping_bar' -%}
                <div class="shipbar" style="background: {{ block.settings.bg_color }}; color: {{ block.settings.text_color }};" {{ block.shopify_attributes }}>
                  <div class="shipbar__label">{{ block.settings.alert_text }}</div>
                  <div class="shipbar__list">
                    {% if block.settings.text_1 != blank %}
                    <div class="shipbar__item">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
                      {{ block.settings.text_1 }}
                    </div>
                    {% endif %}
                    {% if block.settings.text_2 != blank %}
                    <div class="shipbar__item">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>
                      {{ block.settings.text_2 }}
                    </div>
                    {% endif %}
                  </div>
                </div>

              {%- when 'accordion' -%}
                <div class="pfaq-item" {{ block.shopify_attributes }}>
                  <details>
                    <summary class="pfaq-head">
                      <span class="pfaq-left" style="display: flex; gap: 12px; align-items: center;">
                        {% if block.settings.icon != blank %}<img src="{{ block.settings.icon | image_url: width: 24 }}" width="24">{% endif %}
                        <span class="pfaq-title">{{ block.settings.heading }}</span>
                      </span>
                      <span>+</span>
                    </summary>
                    <div class="pfaq-body rte" style="padding-bottom: 15px; color: rgba(255,255,255,0.8); font-size: 14px;">
                      {{ block.settings.content }}
                    </div>
                  </details>
                </div>

              {%- when 'impact_note' -%}
                <div class="impact-note" style="margin: 20px 0; background: #03231A; color: #D4C7B4; border-radius: 12px; display: flex; align-items: center; overflow: hidden;" {{ block.shopify_attributes }}>
                  <div style="padding: 20px; border-right: 1px solid rgba(255,255,255,0.1);">
                    {% if block.settings.icon != blank %}
                      <img src="{{ block.settings.icon | image_url: width: 64 }}" width="32" height="32">
                    {% else %}
                      <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>
                    {% endif %}
                  </div>
                  <div style="padding: 15px; font-size: 14px; line-height: 1.4;">{{ block.settings.text }}</div>
                </div>

            {%- endcase -%}
          {%- endfor -%}

        </product-info>
      </div>
    </div>
  </div>

  {% for block in section.blocks %}
    {% if block.type == 'sticky_atc' %}
      <div id="sticky-atc-{{ section.id }}" class="sticky-atc">
        <img src="{{ product.featured_image | image_url: width: 100 }}" class="sticky-img">
        <div class="sticky-info">
          <div class="sticky-title">{{ product.title | truncate: 25 }}</div>
          <div class="sticky-alert">‚ö†Ô∏è {{ block.settings.alert_text }}</div>
        </div>
        <button class="sticky-btn" onclick="document.querySelector('.pb-atc-btn').scrollIntoView({behavior: 'smooth'})">
          {{ block.settings.btn_text }}
        </button>
      </div>
      <script>
        document.addEventListener('scroll', function() {
          const sticky = document.getElementById('sticky-atc-{{ section.id }}');
          const trigger = document.querySelector('.pb-atc-btn');
          if(sticky && trigger) {
            const rect = trigger.getBoundingClientRect();
            if(rect.top < 0) {
              sticky.classList.add('is-visible');
            } else {
              sticky.classList.remove('is-visible');
            }
          }
        });
      </script>
    {% endif %}
  {% endfor %}

</section>

<script>
class BundleWidget extends HTMLElement {
  constructor() {
    super();
    this.init();
  }

  init() {
    this.tabs = this.querySelectorAll('.pb-size-tab');
    this.cards = this.querySelectorAll('.pb-card');
    this.hiddenInput = this.querySelector('.product-variant-id');
    this.atcDisplayPrice = this.querySelector('.atc-price');
    this.mainPrice = document.querySelector('.ctm-price__current');
    this.mainCompare = document.querySelector('.ctm-price__compare');

    // Handle Tab Clicks (Product Variants)
    this.tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        this.resetAll();
        tab.classList.add('is-active');
        this.updateState(tab.dataset.variantId, tab.dataset.price, tab.dataset.compare);
        this.updateImage(tab.dataset.variantId);
      });
    });

    // Handle Bundle Cards (Different Products)
    this.cards.forEach(card => {
      card.addEventListener('click', () => {
        this.resetAll();
        card.classList.add('is-active');
        this.updateState(card.dataset.variantId, card.dataset.price, card.dataset.compare);
      });
    });
  }

  resetAll() {
    this.tabs.forEach(el => el.classList.remove('is-active'));
    this.cards.forEach(el => el.classList.remove('is-active'));
  }

  updateState(id, price, compare) {
    if(this.hiddenInput) this.hiddenInput.value = id;
    
    // Update Text
    if(this.atcDisplayPrice) this.atcDisplayPrice.innerText = price;
    if(this.mainPrice) this.mainPrice.innerText = price;
    
    if(this.mainCompare) {
      this.mainCompare.innerText = compare ? compare : '';
      this.mainCompare.style.display = compare ? 'inline' : 'none';
    }
  }

  updateImage(id) {
    const url = new URL(window.location);
    url.searchParams.set('variant', id);
    window.history.replaceState({}, '', url);
    window.dispatchEvent(new Event('resize')); 
    
    // Attempt standard Shopify theme gallery switch
    const mediaToSelect = document.querySelector(`[data-target*="${id}"], [data-media-id*="${id}"]`);
    if(mediaToSelect) mediaToSelect.click();
  }
}
customElements.define('bundle-widget', BundleWidget);
</script>

{% schema %}
{
  "name": "Main Product Competitor",
  "tag": "section",
  "class": "section",
  "settings": [
    { "type": "color_background", "id": "bg_gradient", "label": "Background Gradient", "default": "linear-gradient(90deg, #3b3e41 0%, #181a1b 100%)" },
    { "type": "color", "id": "text_color", "label": "Text Color", "default": "#ffffff" },
    { "type": "color", "id": "title_color", "label": "Title Color", "default": "#ffffff" },
    { "type": "color", "id": "price_color", "label": "Price Color", "default": "#E9E2D8" },
    { "type": "color", "id": "compare_price_color", "label": "Compare Price Color", "default": "#888888" },
    { "type": "color", "id": "sale_badge_bg", "label": "Sale Badge BG", "default": "#097350" },
    { "type": "color", "id": "sale_badge_text", "label": "Sale Badge Text", "default": "#E9E2D8" },
    { "type": "header", "content": "Bundle Widget Colors" },
    { "type": "color", "id": "bundle_active_bg", "label": "Active Card BG", "default": "#F6F4F0" },
    { "type": "color", "id": "bundle_border_color", "label": "Border Color", "default": "#E9E2D8" },
    { "type": "color", "id": "atc_bg", "label": "ATC Button BG", "default": "#FFFFFF" },
    { "type": "color", "id": "atc_text", "label": "ATC Button Text", "default": "#121212" },
    { "type": "header", "content": "Section Padding" },
    { "type": "range", "id": "padding_top", "min": 0, "max": 100, "step": 4, "unit": "px", "label": "Padding Top", "default": 36 },
    { "type": "range", "id": "padding_bottom", "min": 0, "max": 100, "step": 4, "unit": "px", "label": "Padding Bottom", "default": 36 },
    { "type": "select", "id": "media_size", "label": "Media Size", "options": [ { "value": "small", "label": "Small" }, { "value": "medium", "label": "Medium" }, { "value": "large", "label": "Large" } ], "default": "large" },
    { "type": "select", "id": "media_position", "label": "Media Position", "options": [ { "value": "left", "label": "Left" }, { "value": "right", "label": "Right" } ], "default": "left" },
    { "type": "select", "id": "gallery_layout", "label": "Gallery Layout", "options": [ { "value": "stacked", "label": "Stacked" }, { "value": "columns", "label": "Columns" }, { "value": "thumbnail_slider", "label": "Thumbnail Slider" } ], "default": "thumbnail_slider" },
    { "type": "checkbox", "id": "enable_sticky_info", "default": true, "label": "Enable Sticky Info" }
  ],
  "blocks": [
    { "type": "@app" },
    {
      "type": "text",
      "name": "Text",
      "settings": [
        { "type": "text", "id": "text", "default": "Immaculate Performance", "label": "Text Content" },
        { "type": "color", "id": "color", "default": "#B0B0B0", "label": "Text Color" },
        { "type": "select", "id": "text_style", "options": [ { "value": "body", "label": "Body" }, { "value": "subtitle", "label": "Subtitle" }, { "value": "uppercase", "label": "Uppercase" } ], "default": "body", "label": "Text Style" },
        { "type": "range", "id": "margin_bottom", "min": 0, "max": 50, "step": 2, "unit": "px", "label": "Margin Bottom", "default": 12 }
      ]
    },
    { "type": "title", "name": "Title", "limit": 1 },
    { "type": "trust_badge", "name": "Trust Badge", "limit": 1 },
    { 
      "type": "price", 
      "name": "Price", 
      "limit": 1, 
      "settings": [
        { "type": "text", "id": "sale_badge_text", "label": "Sale Badge Text", "default": "SALE ENDS SOON!" },
        { "type": "checkbox", "id": "show_description", "label": "Show Short Description", "default": true }
      ]
    },
    { 
      "type": "benefits_grid", 
      "name": "Benefits Grid (4 Icons)", 
      "limit": 1, 
      "settings": [
        { "type": "color", "id": "text_color", "label": "Text Color", "default": "#B0B0B0" },
        { "type": "image_picker", "id": "icon_1", "label": "Icon 1" }, { "type": "text", "id": "text_1", "label": "Text 1", "default": "No PFAS, PTFE & PFOA." },
        { "type": "image_picker", "id": "icon_2", "label": "Icon 2" }, { "type": "text", "id": "text_2", "label": "Text 2", "default": "Extreme Heat Resistant" },
        { "type": "image_picker", "id": "icon_3", "label": "Icon 3" }, { "type": "text", "id": "text_3", "label": "Text 3", "default": "Non-Stick Surface" },
        { "type": "image_picker", "id": "icon_4", "label": "Icon 4" }, { "type": "text", "id": "text_4", "label": "Text 4", "default": "Compatible With All Cooktops" }
      ]
    },
    { 
      "type": "bundle_widget", 
      "name": "Bundle Widget", 
      "limit": 1, 
      "settings": [
        { "type": "text", "id": "size_label", "label": "Size Label", "default": "Size Variant" },
        { "type": "text", "id": "size_guide_text", "label": "Size Guide Link Text", "default": "Size Guide" },
        { "type": "text", "id": "guarantee_text", "label": "Guarantee Text", "default": "Guaranteed Safe & Secure Checkout" },
        { "type": "checkbox", "id": "show_bundles", "label": "Show Bundle Upsells", "default": true },
        { "type": "header", "content": "Bundle 1 Configuration" },
        { "type": "product", "id": "bundle_1_product", "label": "Product Bundle 1" },
        { "type": "text", "id": "bundle_1_desc", "label": "Bundle 1 Description", "default": "Includes standard items." },
        { "type": "header", "content": "Bundle 2 Configuration" },
        { "type": "product", "id": "bundle_2_product", "label": "Product Bundle 2" },
        { "type": "text", "id": "bundle_2_desc", "label": "Bundle 2 Description", "default": "Complete set 10 piece." },
        { "type": "header", "content": "Bundle 3 Configuration" },
        { "type": "product", "id": "bundle_3_product", "label": "Product Bundle 3" },
        { "type": "text", "id": "bundle_3_desc", "label": "Bundle 3 Description", "default": "Complete set 14 piece." }
      ]
    },
    { 
      "type": "shipping_bar", 
      "name": "Shipping Bar", 
      "settings": [
        { "type": "color", "id": "bg_color", "label": "Background Color", "default": "#03231A" },
        { "type": "color", "id": "text_color", "label": "Text Color", "default": "#D4C7B4" },
        { "type": "text", "id": "alert_text", "label": "Alert Text", "default": "Ships By Jan 2nd" },
        { "type": "text", "id": "text_1", "label": "Benefit 1", "default": "FREE Shipping" },
        { "type": "text", "id": "text_2", "label": "Benefit 2", "default": "Lifetime Warranty" }
      ]
    },
    { 
      "type": "accordion", 
      "name": "Accordion Item", 
      "settings": [
        { "type": "text", "id": "heading", "label": "Heading", "default": "Details, Care & Use" },
        { "type": "image_picker", "id": "icon", "label": "Icon" },
        { "type": "richtext", "id": "content", "label": "Content" }
      ]
    },
    {
      "type": "impact_note",
      "name": "Impact Note",
      "settings": [
        { "type": "image_picker", "id": "icon", "label": "Icon" },
        { "type": "textarea", "id": "text", "label": "Text Content", "default": "Part of your order helps create the future of toxin-free living." }
      ]
    },
    {
      "type": "sticky_atc",
      "name": "Sticky ATC Bar",
      "limit": 1,
      "settings": [
        { "type": "text", "id": "alert_text", "label": "Alert Text", "default": "ALMOST SOLD OUT" },
        { "type": "text", "id": "btn_text", "label": "Button Text", "default": "ADD TO CART" }
      ]
    }
  ],
  "presets": [
    {
      "name": "Main Product Competitor",
      "blocks": [
        { "type": "text" },
        { "type": "title" },
        { "type": "trust_badge" },
        { "type": "price" },
        { "type": "benefits_grid" },
        { "type": "bundle_widget" },
        { "type": "shipping_bar" },
        { "type": "accordion" },
        { "type": "impact_note" },
        { "type": "sticky_atc" }
      ]
    }
  ]
}
{% endschema %}